<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="statics/css/user_home_pageStyle.css">
    <script src="statics/js/jquery-3.4.1.min.js" crossorigin="anonymous"></script>
    <title>音樂社團登入首頁</title>
</head>

<body>

    <header>
        <h1>音樂社團</h1>
        <script>
            function getCurrentURLParams() {
                var currentURL = new URL(window.location.href);
                var params = new URLSearchParams(currentURL.search);
                return params;
            }

            function navigateToPage(page) {
                var currentParams = getCurrentURLParams();
                window.location.href = page + '?' + currentParams.toString();
            }
        </script>
    </header>

    <nav>
        <a href="javascript:void(0);" onclick="navigateToPage('borrow.html')">預約器材</a>
        <a href="javascript:void(0);" onclick="navigateToPage('edit_INFO.html')">更改個人資料</a>
        <a href="javascript:void(0);" onclick="navigateToPage('classINFO.html')">報名社課</a>
        <a href="javascript:void(0);" onclick="navigateToPage('article.html')">討論區</a>
        <a href="javascript:void(0);" onclick="navigateToPage('PaidRecord.html')">顯示繳費記錄</a>
        <a href="javascript:void(0);" onclick="navigateToPage('registrationRecord.html')">檢視報名紀錄</a>
        <a href="javascript:void(0);" onclick="navigateToPage('cancelborrow.html')">取消預約</a>
    </nav>

    <section>
        <main>
            <section>
                <ul id="announcementList"></ul>
            </section>
        </main>
    </section>

    <footer>
        <p>&copy; 2023 音樂社團. 版權所有。</p>
    </footer>

    <script>
        $(document).ready(function () {
            getAllAnnouncement();
        });

        function getAllAnnouncement() {
            $.ajax({
                type: "GET",
                url: "api/announcement.do",
                crossDomain: true,
                cache: false,
                dataType: 'json',
                timeout: 5000,
                success: function (response) {
                    if (response.status == 200) {
                        updateAnnouncement(response.response.data);
                    }
                    console.log(response);
                },
                error: function () {
                    alert("無法連線到伺服器！");
                }
            });
        }

        function updateAnnouncement(data) {
            $("#announcementList").empty();
            $.each(data, function (index, value) {
                var listItem = '<li>';
                listItem += '<strong>標題:</strong> ' + value['title'] + '<br>';
				listItem += '<strong>內容:</strong> ' + value['announcement_content'];
				listItem += '</li>';

                $("#announcementList").append(listItem);
            });
        }
    </script>

</body>

</html>

